syntax = "proto3";
package ctx_manager;
import "google/protobuf/empty.proto";


message SaveChatSessionGrpcModel{
    int64 Timestamp = 1;
    string Id = 2;
    string Ip = 3;
    string CountryCode = 4;
    string Host = 5;
    string Origin = 6;
    string UserAgent = 7;
    string Languages = 8;
    string TimeOffset = 9;
    string TimeZone = 10;
    string Tenant = 11;
    string Inventory = 12;

}

message GetLastSessionsGrpcRequest{
    int32 Take = 1;
    bool WithMessagesOnly = 2;
}

message ChatSessionGrpcModel{
    string Id =1;
    string Ip =2;
    string CountryCode = 4;
    string Host = 5;
    string Origin = 6;
    string UserAgent = 7;
    string Languages = 8;
    int64 Created = 9;
    int64 Update = 10;
    string TimeOffset = 11;
    string TimeZone = 12;
    string Tenant = 13;
    string Inventory = 14;
    uint64 MessagesAmount = 15;
}

message GetByIdGrpcRequest{
    string SessionId=1;
}

message UpdateMessagesAmountGrpcRequest{
    string SessionId = 1;
    uint64 Amount =2;
}

service CtxManager {
    rpc SaveChatSessions(stream SaveChatSessionGrpcModel) returns (google.protobuf.Empty);
    rpc GetLastSessions(GetLastSessionsGrpcRequest) returns (stream ChatSessionGrpcModel);
    rpc GetById(GetByIdGrpcRequest) returns (stream ChatSessionGrpcModel);
    rpc UpdateMessagesAmount(stream UpdateMessagesAmountGrpcRequest) returns (google.protobuf.Empty);
    rpc Ping(google.protobuf.Empty) returns (google.protobuf.Empty);
}
